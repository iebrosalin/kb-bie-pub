# 1. Сбросить пароль пользователя root в kali с помощью GNU GRUB
1. Остановится на загрузке ОС. Выбрать Advanced options
![[Pasted image 20241005062914.png]]
2. Нажать кнопке e. Откроется конфиг
![[Pasted image 20241005063235.png]]
3. Заменить "ro” with “rw” и “quiet splash” на “init=/bin/bash”
![[Pasted image 20241005063449.png]]
![[Pasted image 20241005064400.png]]
5. Нажать ctr+x или f10 для загрузки с выбранными параметрами
6. Можно проверить наличие прав на запись смонтированной файловой системы с помощью mount. Командой passwd для нужного пользователя производим сброс пароля игнорируя парольные политики.
![[Pasted image 20241005064648.png]]
8. После изменения пароля дальнейшую загрузку системы можно продолжить командой 
```
exec /sbin/init
```
# 2. Зарегистрироваться на платформах root-me.org и tryhackme.com
На THM давно зареган, правда последние пару лет не решал задачки
![[Pasted image 20241005062221.png]]
Из рутми быстро ушёл, когда узнал про thm и htb. На thm хотя бы системный подход виден комнатах на премиум подписке.
![[Pasted image 20241005062550.png]]
# 3. Скрипты на интерпретируемых языках программирования (bash, python и т.д.) выполняются от имени текущего пользователя даже если на них установлен SUID bit. Это ограничение можно обойти, если создать обертку в виде отдельного бинарного исполняемого файла, запускающего нужный скрипт, а затем добавить необходимые права для неё. Предложите программный код, реализующий такую обертку.
## Решение
```
#include <unistd.h>
int main(void) {
    setgid(0); setuid(0);
    execl("/bin/sh", "sh", 0);
}
```
Вопрос гуглится по запросу suid bash wrapper, что даёт нужный пример по первой ссылке.
Чтобы воспроизвести сценарий обхода нужно выполнить следующие шаги:
```
gcc suid-shell.c -o suid-shell
sudo chown root:root ./suid-shell 
sudo chmod 4755 ./suid-shell
./suid-shell 
```
![[Pasted image 20241005072721.png]]
# 4. Решите следующую задачу. Уберите права на исполнения у  ELF-файла, например, /bin/chmod.
> [!NOTE]
>   # $ chmod -x /bin/chmod  
>   # Выполнить его напрямую теперь нельзя:  
>   # /bin/chmod: Permission denied  
>   # Тем не менее, его все равно можно запустить не изменяя установленные на файл права. Какими способами можно это сделать без перезагрузки,  и как именно они работают?
  
 ## Решение
```
  cp /bin/chmod /tmp/chmod
  chmod -x /tmp/chmod
  /lib64/ld-linux-x86-64.so.2 /tmp/chmod --help
```
Для исполнения можно использовать интерпретатор LD ELF-файлов, который на основе права чтения позволяет прочесть и выполнить построчно исходный код.
 Скриншот выполнения
 ![[Pasted image 20241005061050.png]]
 